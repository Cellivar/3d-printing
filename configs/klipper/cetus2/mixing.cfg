
# *nervously* haha what the fuck?
[gcode_macro MIX]
description: Vertical Gradient Mixing. Gradient adjust automatically to print height.                       #2023-6-6 -Thomas
gcode:
    {% set C = params.C|default(0)|int %}                                           #2024-1-26 Thomas 材料定义数量
    {% set P = params.P|default(1)|int %}                                           #2024-1-26 Thomas 模式：0- 随机；1- 低到高；2-高到低；3-up循环；4-down循环；
    {% set X = params.X|default(1)|float %}                                         #2024-1-26 Thomas 斜率

    {% set DELTA = 0.1 %}
    {% set MIN = (printer["gcode_macro VAR_EXTRUDER"].min_percent) %}
    {% set MAX = (printer["gcode_macro VAR_EXTRUDER"].max_percent) %}
    {% set LAYER = ((printer.print_stats.info.total_layer|int) - 1) %}

    {% set CURRENT  = (printer["gcode_macro VAR_EXTRUDER"].current_percent)  %}
    {% set CURRENT0 = (printer["gcode_macro VAR_EXTRUDER"].current_percent0) %}
    {% set CURRENT1 = (printer["gcode_macro VAR_EXTRUDER"].current_percent1) %}
    {% set CURRENT2 = (printer["gcode_macro VAR_EXTRUDER"].current_percent2) %}
    {% set CURRENT3 = (printer["gcode_macro VAR_EXTRUDER"].current_percent3) %}
    {% set CURRENT4 = (printer["gcode_macro VAR_EXTRUDER"].current_percent4) %}
    {% set CURRENT5 = (printer["gcode_macro VAR_EXTRUDER"].current_percent5) %}
    {% set CURRENT6 = (printer["gcode_macro VAR_EXTRUDER"].current_percent6) %}
    {% set CURRENT7 = (printer["gcode_macro VAR_EXTRUDER"].current_percent7) %}
    {% set CURRENT8 = (printer["gcode_macro VAR_EXTRUDER"].current_percent8) %}
    {% set CURRENT9 = (printer["gcode_macro VAR_EXTRUDER"].current_percent9) %}

    {% set NUM  = (printer["gcode_macro VAR_EXTRUDER"].current_num)  %}
    {% set NUM0 = (printer["gcode_macro VAR_EXTRUDER"].current_num0) %}
    {% set NUM1 = (printer["gcode_macro VAR_EXTRUDER"].current_num1) %}
    {% set NUM2 = (printer["gcode_macro VAR_EXTRUDER"].current_num2) %}
    {% set NUM3 = (printer["gcode_macro VAR_EXTRUDER"].current_num3) %}
    {% set NUM4 = (printer["gcode_macro VAR_EXTRUDER"].current_num4) %}
    {% set NUM5 = (printer["gcode_macro VAR_EXTRUDER"].current_num5) %}
    {% set NUM6 = (printer["gcode_macro VAR_EXTRUDER"].current_num6) %}
    {% set NUM7 = (printer["gcode_macro VAR_EXTRUDER"].current_num7) %}
    {% set NUM8 = (printer["gcode_macro VAR_EXTRUDER"].current_num8) %}
    {% set NUM9 = (printer["gcode_macro VAR_EXTRUDER"].current_num9) %}

    {% if P == 0 %}

      {% set T = range(MIN, MAX) | random %}

  	  {% if C == 0 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT0: {T}
	    {% elif C == 1 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT1: {T}
	    {% elif C == 2 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT2: {T}
  	  {% elif C == 3 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT3: {T}
	    {% elif C == 4 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT4: {T}
	    {% elif C == 5 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT5: {T}
  	  {% elif C == 6 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT6: {T}
	    {% elif C == 7 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT7: {T}
	    {% elif C == 8 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT8: {T}
  	  {% elif C == 9 %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT9: {T}
	    {% else %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={T}
        M306 P{T}
        M118 CURRENTPERCENT: {T}
	    {% endif %}



    {% elif P == 1 %}
	    {% if C == 0 %}
        {% if CURRENT0 < MAX %}
          M306 P{CURRENT0}
          M118 CURRENTPERCENT0: {CURRENT0}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0+1)}
          {% endif %}
        {% elif CURRENT0 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT0: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT0: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 1 %}
        {% if CURRENT1 < MAX %}
          M306 P{CURRENT1}
          M118 CURRENTPERCENT1: {CURRENT1}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1+1)}
          {% endif %}
        {% elif CURRENT1 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT1: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT1: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 2 %}
        {% if CURRENT2 < MAX %}
          M306 P{CURRENT2}
          M118 CURRENTPERCENT2: {CURRENT2}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2+1)}
          {% endif %}
        {% elif CURRENT2 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT2: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT2: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 3 %}
        {% if CURRENT3 < MAX %}
          M306 P{CURRENT3}
          M118 CURRENTPERCENT3: {CURRENT3}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3+1)}
          {% endif %}
        {% elif CURRENT3 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT3: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT3: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 4 %}
        {% if CURRENT4 < MAX %}
          M306 P{CURRENT4}
          M118 CURRENTPERCENT4: {CURRENT4}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4+1)}
          {% endif %}
        {% elif CURRENT4 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT4: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT4: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 5 %}
        {% if CURRENT5 < MAX %}
          M306 P{CURRENT5}
          M118 CURRENTPERCENT5: {CURRENT5}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5+1)}
          {% endif %}
        {% elif CURRENT5 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT5: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT5: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 6 %}
        {% if CURRENT6 < MAX %}
          M306 P{CURRENT6}
          M118 CURRENTPERCENT6: {CURRENT6}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6+1)}
          {% endif %}
        {% elif CURRENT6 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT6: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT6: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 7 %}
        {% if CURRENT7 < MAX %}
          M306 P{CURRENT7}
          M118 CURRENTPERCENT7: {CURRENT7}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7+1)}
          {% endif %}
        {% elif CURRENT7 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT7: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT7: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 8 %}
        {% if CURRENT8 < MAX %}
          M306 P{CURRENT8}
          M118 CURRENTPERCENT8: {CURRENT8}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8+1)}
          {% endif %}
        {% elif CURRENT8 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT8: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT8: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% elif C == 9 %}
        {% if CURRENT9 < MAX %}
          M306 P{CURRENT9}
          M118 CURRENTPERCENT9: {CURRENT9}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9+1)}
          {% endif %}
        {% elif CURRENT9 < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT9: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT9: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% else %}
        {% if CURRENT < MAX %}
          M306 P{CURRENT}
          M118 CURRENTPERCENT: {CURRENT}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT+1)}
          {% endif %}
        {% elif CURRENT < (MAX + DELTA) %}
          M306 P{MAX}
          M118 CURRENTPERCENT: {MAX}
          SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MIN}
        {% else %}
          M306 P{MIN}
          M118 CURRENTPERCENT: {MIN}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MIN+1*X*(MAX-MIN)/LAYER)}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MIN+1)}
          {% endif %}
        {% endif %}
	    {% endif %}
    {% elif P == 2 %}
      {% if CURRENT == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT0 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT1 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT2 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT3 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT4 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT5 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT6 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT7 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT8 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MAX}
      {% else %}
      {% endif %}
      {% if CURRENT9 == MIN %}
        SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MAX}
      {% else %}
      {% endif %}
	    {% if C == 0 %}
        {% if MIN < CURRENT0 %}
          M306 P{CURRENT0}
          M118 CURRENTPERCENT0: {CURRENT0}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0-1)}
          {% endif %}
        {% elif MIN == CURRENT0 %}
          M306 P{MAX}
          M118 CURRENTPERCENT0: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT0 + DELTA)%}
          M306 P{CURRENT0}
          M118 CURRENTPERCENT0: {CURRENT0}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(CURRENT0-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT0: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 1 %}
        {% if MIN < CURRENT1 %}
          M306 P{CURRENT1}
          M118 CURRENTPERCENT1: {CURRENT1}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1-1)}
          {% endif %}
        {% elif MIN == CURRENT1 %}
          M306 P{MAX}
          M118 CURRENTPERCENT1: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT1 + DELTA)%}
          M306 P{CURRENT1}
          M118 CURRENTPERCENT1: {CURRENT1}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(CURRENT1-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT1: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 2 %}
        {% if MIN < CURRENT2 %}
          M306 P{CURRENT2}
          M118 CURRENTPERCENT2: {CURRENT2}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2-1)}
          {% endif %}
        {% elif MIN == CURRENT2 %}
          M306 P{MAX}
          M118 CURRENTPERCENT2: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT2 + DELTA)%}
          M306 P{CURRENT2}
          M118 CURRENTPERCENT2: {CURRENT2}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(CURRENT2-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT2: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 3 %}
        {% if MIN < CURRENT3 %}
          M306 P{CURRENT3}
          M118 CURRENTPERCENT3: {CURRENT3}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3-1)}
          {% endif %}
        {% elif MIN == CURRENT3 %}
          M306 P{MAX}
          M118 CURRENTPERCENT3: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT3 + DELTA)%}
          M306 P{CURRENT3}
          M118 CURRENTPERCENT3: {CURRENT3}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(CURRENT3-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT3: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 4 %}
        {% if MIN < CURRENT4 %}
          M306 P{CURRENT4}
          M118 CURRENTPERCENT4: {CURRENT4}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4-1)}
          {% endif %}
        {% elif MIN == CURRENT4 %}
          M306 P{MAX}
          M118 CURRENTPERCENT4: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT4 + DELTA)%}
          M306 P{CURRENT4}
          M118 CURRENTPERCENT4: {CURRENT4}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(CURRENT4-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT4: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 5 %}
        {% if MIN < CURRENT5 %}
          M306 P{CURRENT5}
          M118 CURRENTPERCENT5: {CURRENT5}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5-1)}
          {% endif %}
        {% elif MIN == CURRENT5 %}
          M306 P{MAX}
          M118 CURRENTPERCENT5: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT5 + DELTA)%}
          M306 P{CURRENT5}
          M118 CURRENTPERCENT5: {CURRENT5}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(CURRENT5-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT5: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 6 %}
        {% if MIN < CURRENT6 %}
          M306 P{CURRENT6}
          M118 CURRENTPERCENT6: {CURRENT6}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6-1)}
          {% endif %}
        {% elif MIN == CURRENT6 %}
          M306 P{MAX}
          M118 CURRENTPERCENT6: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT6 + DELTA)%}
          M306 P{CURRENT6}
          M118 CURRENTPERCENT6: {CURRENT6}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(CURRENT6-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT6: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 7 %}
        {% if MIN < CURRENT7 %}
          M306 P{CURRENT7}
          M118 CURRENTPERCENT7: {CURRENT7}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7-1)}
          {% endif %}
        {% elif MIN == CURRENT7 %}
          M306 P{MAX}
          M118 CURRENTPERCENT7: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT7 + DELTA)%}
          M306 P{CURRENT7}
          M118 CURRENTPERCENT7: {CURRENT7}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(CURRENT7-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT7: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 8 %}
        {% if MIN < CURRENT8 %}
          M306 P{CURRENT8}
          M118 CURRENTPERCENT8: {CURRENT8}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8-1)}
          {% endif %}
        {% elif MIN == CURRENT8 %}
          M306 P{MAX}
          M118 CURRENTPERCENT8: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT8 + DELTA)%}
          M306 P{CURRENT8}
          M118 CURRENTPERCENT8: {CURRENT8}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(CURRENT8-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT8: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% elif C == 9 %}
        {% if MIN < CURRENT9 %}
          M306 P{CURRENT9}
          M118 CURRENTPERCENT9: {CURRENT9}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9-1)}
          {% endif %}
        {% elif MIN == CURRENT9 %}
          M306 P{MAX}
          M118 CURRENTPERCENT9: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT9 + DELTA)%}
          M306 P{CURRENT9}
          M118 CURRENTPERCENT9: {CURRENT9}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(CURRENT9-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT9: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% else %}
        {% if MIN < CURRENT %}
          M306 P{CURRENT}
          M118 CURRENTPERCENT: {CURRENT}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT-1)}
          {% endif %}
        {% elif MIN == CURRENT %}
          M306 P{MAX}
          M118 CURRENTPERCENT: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MAX-1)}
          {% endif %}
        {% elif MIN < (CURRENT + DELTA)%}
          M306 P{CURRENT}
          M118 CURRENTPERCENT: {CURRENT}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(CURRENT-1)}
          {% endif %}
        {% else %}
          M306 P{MAX}
          M118 CURRENTPERCENT: {MAX}
          {% if LAYER > 0 %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MAX-1*X*(MAX-MIN)/(LAYER))}
          {% else %}
            SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={(MAX-1)}
          {% endif %}
        {% endif %}
	    {% endif %}
    {% elif P == 3 %}
	    {% if C == 0 %}
        {% if NUM0 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP0 = (CURRENT0+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP0 = (CURRENT0+2*X) %}
          {% endif %}
          {% if CURRENT0 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT0: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
          {% elif CURRENT0 < MAX %}
            {% if CURRENT_TEMP0 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT0: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num0 VALUE={(NUM0+1)}
            {% else %}
              M306 P{CURRENT0}
              M118 CURRENTPERCENT0: {CURRENT0}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP0 = (CURRENT0-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP0 = (CURRENT0-2*X) %}
          {% endif %}
          {% if MIN == CURRENT0 %}
              M306 P{MIN}
              M118 CURRENTPERCENT0: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
          {% elif MIN < CURRENT0 %}
            {% if CURRENT_TEMP0 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT0: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num0 VALUE={(NUM0+1)}
            {% else %}
              M306 P{CURRENT_TEMP0}
              M118 CURRENTPERCENT0: {CURRENT_TEMP0}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 1 %}
        {% if NUM1 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP1 = (CURRENT1+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP1 = (CURRENT1+2*X) %}
          {% endif %}
          {% if CURRENT1 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT1: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
          {% elif CURRENT1 < MAX %}
            {% if CURRENT_TEMP1 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT1: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num1 VALUE={(NUM1+1)}
            {% else %}
              M306 P{CURRENT1}
              M118 CURRENTPERCENT1: {CURRENT1}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP1 = (CURRENT1-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP1 = (CURRENT1-2*X) %}
          {% endif %}
          {% if MIN == CURRENT1 %}
              M306 P{MIN}
              M118 CURRENTPERCENT1: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
          {% elif MIN < CURRENT1 %}
            {% if CURRENT_TEMP1 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT1: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num1 VALUE={(NUM1+1)}
            {% else %}
              M306 P{CURRENT_TEMP1}
              M118 CURRENTPERCENT1: {CURRENT_TEMP1}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 2 %}
        {% if NUM2 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP2 = (CURRENT2+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP2 = (CURRENT2+2*X) %}
          {% endif %}
          {% if CURRENT2 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT2: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
          {% elif CURRENT2 < MAX %}
            {% if CURRENT_TEMP2 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT2: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num2 VALUE={(NUM2+1)}
            {% else %}
              M306 P{CURRENT2}
              M118 CURRENTPERCENT2: {CURRENT2}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP2 = (CURRENT2-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP2 = (CURRENT2-2*X) %}
          {% endif %}
          {% if MIN == CURRENT2 %}
              M306 P{MIN}
              M118 CURRENTPERCENT2: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
          {% elif MIN < CURRENT2 %}
            {% if CURRENT_TEMP2 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT2: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num2 VALUE={(NUM2+1)}
            {% else %}
              M306 P{CURRENT_TEMP2}
              M118 CURRENTPERCENT2: {CURRENT_TEMP2}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 3 %}
        {% if NUM3 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP3 = (CURRENT3+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP3 = (CURRENT3+2*X) %}
          {% endif %}
          {% if CURRENT3 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT3: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
          {% elif CURRENT3 < MAX %}
            {% if CURRENT_TEMP3 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT3: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num3 VALUE={(NUM3+1)}
            {% else %}
              M306 P{CURRENT3}
              M118 CURRENTPERCENT3: {CURRENT3}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP3 = (CURRENT3-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP3 = (CURRENT3-2*X) %}
          {% endif %}
          {% if MIN == CURRENT3 %}
              M306 P{MIN}
              M118 CURRENTPERCENT3: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
          {% elif MIN < CURRENT3 %}
            {% if CURRENT_TEMP3 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT3: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num3 VALUE={(NUM3+1)}
            {% else %}
              M306 P{CURRENT_TEMP3}
              M118 CURRENTPERCENT3: {CURRENT_TEMP3}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 4 %}
        {% if NUM4 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP4 = (CURRENT4+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP4 = (CURRENT4+2*X) %}
          {% endif %}
          {% if CURRENT4 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT4: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
          {% elif CURRENT4 < MAX %}
            {% if CURRENT_TEMP4 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT4: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num4 VALUE={(NUM4+1)}
            {% else %}
              M306 P{CURRENT4}
              M118 CURRENTPERCENT4: {CURRENT4}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP4 = (CURRENT4-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP4 = (CURRENT4-2*X) %}
          {% endif %}
          {% if MIN == CURRENT4 %}
              M306 P{MIN}
              M118 CURRENTPERCENT4: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
          {% elif MIN < CURRENT4 %}
            {% if CURRENT_TEMP4 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT4: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num4 VALUE={(NUM4+1)}
            {% else %}
              M306 P{CURRENT_TEMP4}
              M118 CURRENTPERCENT4: {CURRENT_TEMP4}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 5 %}
        {% if NUM5 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP5 = (CURRENT5+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP5 = (CURRENT5+2*X) %}
          {% endif %}
          {% if CURRENT5 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT5: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
          {% elif CURRENT5 < MAX %}
            {% if CURRENT_TEMP5 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT5: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num5 VALUE={(NUM5+1)}
            {% else %}
              M306 P{CURRENT5}
              M118 CURRENTPERCENT5: {CURRENT5}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP5 = (CURRENT5-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP5 = (CURRENT5-2*X) %}
          {% endif %}
          {% if MIN == CURRENT5 %}
              M306 P{MIN}
              M118 CURRENTPERCENT5: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
          {% elif MIN < CURRENT5 %}
            {% if CURRENT_TEMP5 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT5: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num5 VALUE={(NUM5+1)}
            {% else %}
              M306 P{CURRENT_TEMP5}
              M118 CURRENTPERCENT5: {CURRENT_TEMP5}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 6 %}
        {% if NUM6 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP6 = (CURRENT6+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP6 = (CURRENT6+2*X) %}
          {% endif %}
          {% if CURRENT6 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT6: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
          {% elif CURRENT6 < MAX %}
            {% if CURRENT_TEMP6 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT6: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num6 VALUE={(NUM6+1)}
            {% else %}
              M306 P{CURRENT6}
              M118 CURRENTPERCENT6: {CURRENT6}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP6 = (CURRENT6-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP6 = (CURRENT6-2*X) %}
          {% endif %}
          {% if MIN == CURRENT6 %}
              M306 P{MIN}
              M118 CURRENTPERCENT6: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
          {% elif MIN < CURRENT6 %}
            {% if CURRENT_TEMP6 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT6: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num6 VALUE={(NUM6+1)}
            {% else %}
              M306 P{CURRENT_TEMP6}
              M118 CURRENTPERCENT6: {CURRENT_TEMP6}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 7 %}
        {% if NUM7 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP7 = (CURRENT7+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP7 = (CURRENT7+2*X) %}
          {% endif %}
          {% if CURRENT7 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT7: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
          {% elif CURRENT7 < MAX %}
            {% if CURRENT_TEMP7 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT7: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num7 VALUE={(NUM7+1)}
            {% else %}
              M306 P{CURRENT7}
              M118 CURRENTPERCENT7: {CURRENT7}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP7 = (CURRENT7-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP7 = (CURRENT7-2*X) %}
          {% endif %}
          {% if MIN == CURRENT7 %}
              M306 P{MIN}
              M118 CURRENTPERCENT7: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
          {% elif MIN < CURRENT7 %}
            {% if CURRENT_TEMP7 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT7: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num7 VALUE={(NUM7+1)}
            {% else %}
              M306 P{CURRENT_TEMP7}
              M118 CURRENTPERCENT7: {CURRENT_TEMP7}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 8 %}
        {% if NUM8 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP8 = (CURRENT8+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP8 = (CURRENT8+2*X) %}
          {% endif %}
          {% if CURRENT8 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT8: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
          {% elif CURRENT8 < MAX %}
            {% if CURRENT_TEMP8 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT8: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num8 VALUE={(NUM8+1)}
            {% else %}
              M306 P{CURRENT8}
              M118 CURRENTPERCENT8: {CURRENT8}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP8 = (CURRENT8-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP8 = (CURRENT8-2*X) %}
          {% endif %}
          {% if MIN == CURRENT8 %}
              M306 P{MIN}
              M118 CURRENTPERCENT8: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
          {% elif MIN < CURRENT8 %}
            {% if CURRENT_TEMP8 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT8: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num8 VALUE={(NUM8+1)}
            {% else %}
              M306 P{CURRENT_TEMP8}
              M118 CURRENTPERCENT8: {CURRENT_TEMP8}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 9 %}
        {% if NUM9 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP9 = (CURRENT9+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP9 = (CURRENT9+2*X) %}
          {% endif %}
          {% if CURRENT9 == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT9: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
          {% elif CURRENT9 < MAX %}
            {% if CURRENT_TEMP9 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT9: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num9 VALUE={(NUM9+1)}
            {% else %}
              M306 P{CURRENT9}
              M118 CURRENTPERCENT9: {CURRENT9}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP9 = (CURRENT9-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP9 = (CURRENT9-2*X) %}
          {% endif %}
          {% if MIN == CURRENT9 %}
              M306 P{MIN}
              M118 CURRENTPERCENT9: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
          {% elif MIN < CURRENT9 %}
            {% if CURRENT_TEMP9 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT9: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num9 VALUE={(NUM9+1)}
            {% else %}
              M306 P{CURRENT_TEMP9}
              M118 CURRENTPERCENT9: {CURRENT_TEMP9}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% else %}
        {% if NUM % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP = (CURRENT+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP = (CURRENT+2*X) %}
          {% endif %}
          {% if CURRENT == MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
          {% elif CURRENT < MAX %}
            {% if CURRENT_TEMP > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num VALUE={(NUM+1)}
            {% else %}
              M306 P{CURRENT}
              M118 CURRENTPERCENT: {CURRENT}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP = (CURRENT-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP = (CURRENT-2*X) %}
          {% endif %}
          {% if MIN == CURRENT %}
              M306 P{MIN}
              M118 CURRENTPERCENT: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
          {% elif MIN < CURRENT %}
            {% if CURRENT_TEMP < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num VALUE={(NUM+1)}
            {% else %}
              M306 P{CURRENT_TEMP}
              M118 CURRENTPERCENT: {CURRENT_TEMP}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% endif %}
    {% elif P == 4 %}
      # {% if CURRENT == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT0 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT1 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT2 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT3 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT4 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT5 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT6 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT7 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT8 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MAX}
      # {% else %}
      # {% endif %}
      # {% if CURRENT9 == MIN %}
      #   SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MAX}
      # {% else %}
      # {% endif %}
	    {% if C == 0 %}
        {% if NUM0 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP0 = (CURRENT0-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP0 = (CURRENT0-2*X) %}
          {% endif %}
          {% if MIN < CURRENT0 %}
            {% if CURRENT_TEMP0 <= MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT0: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num0 VALUE={(NUM0+1)}
            {% else %}
              M306 P{CURRENT_TEMP0}
              M118 CURRENTPERCENT0: {CURRENT_TEMP0}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
            {% endif %}
          {% elif MIN == CURRENT0 %}
            {% if NUM0 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT0: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP0 = (CURRENT0+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP0 = (CURRENT0+2*X) %}
          {% endif %}
          {% if CURRENT0 < MAX %}
            {% if CURRENT_TEMP0 >= MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT0: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num0 VALUE={(NUM0+1)}
            {% else %}
              M306 P{CURRENT_TEMP0}
              M118 CURRENTPERCENT0: {CURRENT_TEMP0}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent0 VALUE={CURRENT_TEMP0}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 1 %}
        {% if NUM1 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP1 = (CURRENT1-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP1 = (CURRENT1-2*X) %}
          {% endif %}
          {% if MIN < CURRENT1 %}
            {% if CURRENT_TEMP1 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT1: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num1 VALUE={(NUM1+1)}
            {% else %}
              M306 P{CURRENT_TEMP1}
              M118 CURRENTPERCENT1: {CURRENT_TEMP1}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
            {% endif %}
          {% elif MIN == CURRENT1 %}
            {% if NUM1 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT1: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP1 = (CURRENT1+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP1 = (CURRENT1+2*X) %}
          {% endif %}
          {% if CURRENT1 < MAX %}
            {% if CURRENT_TEMP1 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT1: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num1 VALUE={(NUM1+1)}
            {% else %}
              M306 P{CURRENT_TEMP1}
              M118 CURRENTPERCENT1: {CURRENT_TEMP1}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent1 VALUE={CURRENT_TEMP1}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 2 %}
        {% if NUM2 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP2 = (CURRENT2-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP2 = (CURRENT2-2*X) %}
          {% endif %}
          {% if MIN < CURRENT2 %}
            {% if CURRENT_TEMP2 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT2: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num2 VALUE={(NUM2+1)}
            {% else %}
              M306 P{CURRENT_TEMP2}
              M118 CURRENTPERCENT2: {CURRENT_TEMP2}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
            {% endif %}
          {% elif MIN == CURRENT2 %}
            {% if NUM2 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT2: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP2 = (CURRENT2+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP2 = (CURRENT2+2*X) %}
          {% endif %}
          {% if CURRENT2 < MAX %}
            {% if CURRENT_TEMP2 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT2: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num2 VALUE={(NUM2+1)}
            {% else %}
              M306 P{CURRENT_TEMP2}
              M118 CURRENTPERCENT2: {CURRENT_TEMP2}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent2 VALUE={CURRENT_TEMP2}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 3 %}
        {% if NUM3 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP3 = (CURRENT3-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP3 = (CURRENT3-2*X) %}
          {% endif %}
          {% if MIN < CURRENT3 %}
            {% if CURRENT_TEMP3 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT3: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num3 VALUE={(NUM3+1)}
            {% else %}
              M306 P{CURRENT_TEMP3}
              M118 CURRENTPERCENT3: {CURRENT_TEMP3}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
            {% endif %}
          {% elif MIN == CURRENT3 %}
            {% if NUM3 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT3: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP3 = (CURRENT3+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP3 = (CURRENT3+2*X) %}
          {% endif %}
          {% if CURRENT3 < MAX %}
            {% if CURRENT_TEMP3 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT3: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num3 VALUE={(NUM3+1)}
            {% else %}
              M306 P{CURRENT_TEMP3}
              M118 CURRENTPERCENT3: {CURRENT_TEMP3}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent3 VALUE={CURRENT_TEMP3}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 4 %}
        {% if NUM4 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP4 = (CURRENT4-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP4 = (CURRENT4-2*X) %}
          {% endif %}
          {% if MIN < CURRENT4 %}
            {% if CURRENT_TEMP4 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT4: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num4 VALUE={(NUM4+1)}
            {% else %}
              M306 P{CURRENT_TEMP4}
              M118 CURRENTPERCENT4: {CURRENT_TEMP4}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
            {% endif %}
          {% elif MIN == CURRENT4 %}
            {% if NUM4 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT4: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP4 = (CURRENT4+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP4 = (CURRENT4+2*X) %}
          {% endif %}
          {% if CURRENT4 < MAX %}
            {% if CURRENT_TEMP4 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT4: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num4 VALUE={(NUM4+1)}
            {% else %}
              M306 P{CURRENT_TEMP4}
              M118 CURRENTPERCENT4: {CURRENT_TEMP4}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent4 VALUE={CURRENT_TEMP4}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 5 %}
        {% if NUM5 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP5 = (CURRENT5-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP5 = (CURRENT5-2*X) %}
          {% endif %}
          {% if MIN < CURRENT5 %}
            {% if CURRENT_TEMP5 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT5: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num5 VALUE={(NUM5+1)}
            {% else %}
              M306 P{CURRENT_TEMP5}
              M118 CURRENTPERCENT5: {CURRENT_TEMP5}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
            {% endif %}
          {% elif MIN == CURRENT5 %}
            {% if NUM5 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT5: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP5 = (CURRENT5+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP5 = (CURRENT5+2*X) %}
          {% endif %}
          {% if CURRENT5 < MAX %}
            {% if CURRENT_TEMP5 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT5: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num5 VALUE={(NUM5+1)}
            {% else %}
              M306 P{CURRENT_TEMP5}
              M118 CURRENTPERCENT5: {CURRENT_TEMP5}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent5 VALUE={CURRENT_TEMP5}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 6 %}
        {% if NUM6 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP6 = (CURRENT6-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP6 = (CURRENT6-2*X) %}
          {% endif %}
          {% if MIN < CURRENT6 %}
            {% if CURRENT_TEMP6 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT6: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num6 VALUE={(NUM6+1)}
            {% else %}
              M306 P{CURRENT_TEMP6}
              M118 CURRENTPERCENT6: {CURRENT_TEMP6}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
            {% endif %}
          {% elif MIN == CURRENT6 %}
            {% if NUM6 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT6: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP6 = (CURRENT6+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP6 = (CURRENT6+2*X) %}
          {% endif %}
          {% if CURRENT6 < MAX %}
            {% if CURRENT_TEMP6 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT6: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num6 VALUE={(NUM6+1)}
            {% else %}
              M306 P{CURRENT_TEMP6}
              M118 CURRENTPERCENT6: {CURRENT_TEMP6}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent6 VALUE={CURRENT_TEMP6}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 7 %}
        {% if NUM7 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP7 = (CURRENT7-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP7 = (CURRENT7-2*X) %}
          {% endif %}
          {% if MIN < CURRENT7 %}
            {% if CURRENT_TEMP7 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT7: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num7 VALUE={(NUM7+1)}
            {% else %}
              M306 P{CURRENT_TEMP7}
              M118 CURRENTPERCENT7: {CURRENT_TEMP7}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
            {% endif %}
          {% elif MIN == CURRENT7 %}
            {% if NUM7 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT7: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP7 = (CURRENT7+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP7 = (CURRENT7+2*X) %}
          {% endif %}
          {% if CURRENT7 < MAX %}
            {% if CURRENT_TEMP7 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT7: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num7 VALUE={(NUM7+1)}
            {% else %}
              M306 P{CURRENT_TEMP7}
              M118 CURRENTPERCENT7: {CURRENT_TEMP7}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent7 VALUE={CURRENT_TEMP7}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 8 %}
        {% if NUM8 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP8 = (CURRENT8-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP8 = (CURRENT8-2*X) %}
          {% endif %}
          {% if MIN < CURRENT8 %}
            {% if CURRENT_TEMP8 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT8: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num8 VALUE={(NUM8+1)}
            {% else %}
              M306 P{CURRENT_TEMP8}
              M118 CURRENTPERCENT8: {CURRENT_TEMP8}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
            {% endif %}
          {% elif MIN == CURRENT8 %}
            {% if NUM8 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT8: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP8 = (CURRENT8+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP8 = (CURRENT8+2*X) %}
          {% endif %}
          {% if CURRENT8 < MAX %}
            {% if CURRENT_TEMP8 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT8: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num8 VALUE={(NUM8+1)}
            {% else %}
              M306 P{CURRENT_TEMP8}
              M118 CURRENTPERCENT8: {CURRENT_TEMP8}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent8 VALUE={CURRENT_TEMP8}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% elif C == 9 %}
        {% if NUM9 % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP9 = (CURRENT9-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP9 = (CURRENT9-2*X) %}
          {% endif %}
          {% if MIN < CURRENT9 %}
            {% if CURRENT_TEMP9 < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT9: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num9 VALUE={(NUM9+1)}
            {% else %}
              M306 P{CURRENT_TEMP9}
              M118 CURRENTPERCENT9: {CURRENT_TEMP9}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
            {% endif %}
          {% elif MIN == CURRENT9 %}
            {% if NUM9 == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT9: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP9 = (CURRENT9+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP9 = (CURRENT9+2*X) %}
          {% endif %}
          {% if CURRENT9 < MAX %}
            {% if CURRENT_TEMP9 > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT9: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num9 VALUE={(NUM9+1)}
            {% else %}
              M306 P{CURRENT_TEMP9}
              M118 CURRENTPERCENT9: {CURRENT_TEMP9}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent9 VALUE={CURRENT_TEMP9}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
	    {% else %}
        {% if NUM % 2 == 0 %}                              #偶数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP = (CURRENT-2*X*(MAX-MIN)/(LAYER)) %}
          {% else %}
            {% set CURRENT_TEMP = (CURRENT-2*X) %}
          {% endif %}
          {% if MIN < CURRENT %}
            {% if CURRENT_TEMP < MIN %}
              M306 P{MIN}
              M118 CURRENTPERCENT: {MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MIN}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num VALUE={(NUM+1)}
            {% else %}
              M306 P{CURRENT_TEMP}
              M118 CURRENTPERCENT: {CURRENT_TEMP}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
            {% endif %}
          {% elif MIN == CURRENT %}
            {% if NUM == 0 %}
              M306 P{MAX}
              M118 CURRENTPERCENT: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MAX}
            {% else %}
            {% endif %}
          {% else %}
          {% endif %}
        {% else %}                                                        #奇数
          {% if LAYER > 0 %}
            {% set CURRENT_TEMP = (CURRENT+2*X*(MAX-MIN)/LAYER) %}
          {% else %}
            {% set CURRENT_TEMP = (CURRENT+2*X) %}
          {% endif %}
          {% if CURRENT < MAX %}
            {% if CURRENT_TEMP > MAX %}
              M306 P{MAX}
              M118 CURRENTPERCENT: {MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={MAX}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_num VALUE={(NUM+1)}
            {% else %}
              M306 P{CURRENT_TEMP}
              M118 CURRENTPERCENT: {CURRENT_TEMP}
              SET_GCODE_VARIABLE MACRO=VAR_EXTRUDER VARIABLE=current_percent VALUE={CURRENT_TEMP}
            {% endif %}
          {% else %}
          {% endif %}
        {% endif %}
      {% endif %}
	  {% else %}
    {% endif %}

